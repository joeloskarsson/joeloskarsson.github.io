<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Machine Learning for Transport Mode Classification | Joel Oskarsson </title> <meta name="author" content="Joel Oskarsson"> <meta name="description" content="Personal webpage of Joel Oskarsson. "> <meta name="keywords" content="joel, oskarsson, machine learning, ml, research, academic"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/me.jpg?cedc15379e19940d27cc667d8e25dd2a"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://joeloskarsson.github.io/blog/2019/transport-mode/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Joel</span> Oskarsson </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Machine Learning for Transport Mode Classification</h1> <p class="post-meta"> Created on February 03, 2019 by Joel Oskarsson </p> <p class="post-tags"> <a href="/blog/2019"> <i class="fa-solid fa-calendar fa-sm"></i> 2019 </a>   ·   <a href="/blog/category/transport"> <i class="fa-solid fa-tag fa-sm"></i> transport</a>   <a href="/blog/category/app"> <i class="fa-solid fa-tag fa-sm"></i> app</a>   <a href="/blog/category/ml"> <i class="fa-solid fa-tag fa-sm"></i> ml</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>This fall I encountered the quite interesting problem of inferring what mode of transportation a person is using based on sensor data. The context for this was my smart energy course. The course is broadly about using ICT to enable sustainable energy usage and one of our assigned projects was to develop an android app to let people track their daily energy usage from transportation. For this me and my group trained a classifier based on speed measurements from the smartphone GPS.</p> <p>There is plenty of research on this topic and I don’t claim to provide a complete coverage of the area. See this rather as a short introduction to an interesting application of machine learning. For a more academic resource I refer to <a href="https://infoscience.epfl.ch/record/229181/" rel="external nofollow noopener" target="_blank">this great review paper</a> by Nikolić and Bierlaire.</p> <h3 id="the-problem-of-transport-mode-classification">The Problem of Transport Mode Classification</h3> <p>Transport mode classification is the problem of based on some data classifying what mode of transportation a person is currently using. In this setting that data mainly comes from a carried smartphone. How specific the classification should be can be different in different applications, but some categories generally considered are:</p> <ul> <li>Walking</li> <li>Bicycle</li> <li>Car</li> <li>Bus</li> <li>Tram</li> <li>Train</li> </ul> <p>Sometimes groups of these are considered, for example motorized or not.</p> <h3 id="sensors-and-data">Sensors and Data</h3> <p>Typically data from smartphone sensors is used. This makes sense since most people would already carry their smartphone while traveling. Some type of specialized hardware could however also be considered.</p> <p>The main pieces of data used are speed and acceleration, based on position measurements. Speed and acceleration can be estimated from numerical differentiation of position, but one can consider using for example an accelerometer to measure acceleration more accurately. The position can be retrieved from the GPS module of a smartphone. Note that the absolute position (position on earth) is a poor feature choice since it would require training on data from every exact location the system should function at.</p> <p>External data can also be used to improve predictions. One way to make position data useful is to combine it with public transport maps and timetables. By comparing the user’s position with trajectories of trams, buses and trains these modes could easily be classified. Note that this requires (real-time) web APIs for public transport routes. Some other ways to bring more data into the prediction is to compare movements to other users or earlier trips. Taking past trips into account leads to an extension of the classification problem to also infer travel patterns. I do not intend to discuss this further here, but this is an interesting problem in its own right.</p> <h3 id="machine-learning-approaches">Machine Learning Approaches</h3> <p>There are two main approaches to learning a classifier for transport modes. The first is to treat the previously mentioned data as a time series and directly feed this to the classifier. The input data then has a time-dimension of varying length and (dependent on exactly what is measured) one or more channels at each time-step. At least the speed at each time-step would be included in such an approach. In this group we find Hidden Markov Models, which is one of the most popular approaches to this problem. Another, maybe more modern, approach is Artificial Neural Networks. The typical approach to time-series classification with ANNs is using a recurrent network and LSTM units. The neural network approach is much more rare, but could be an interesting future project.</p> <p>The second main approach to the problem is to first extract features from the raw data. This opens up to a larger family of possible machine learning models since the data no longer has the shape of a time-series. Features extracted here are generally different statistical properties of the speed or acceleration throughout one trip. Common models used are decision trees, K nearest neighbor and support vector machines.</p> <h3 id="my-solution">My Solution</h3> <p>For my course project I took the main responsibility of training our classifiers. We were handed a small dataset which we had helped out collecting and labeling earlier. Because of limited time I chose to go with the second of the approaches discussed earlier and extracted a set of features from each trip to be classified.</p> <p>The features I used was inspired mainly by <a href="https://www.mdpi.com/2078-2489/6/2/212" rel="external nofollow noopener" target="_blank">Zong et al.</a>, with the difference that I chose not to use acceleration in the final classifier. I did some experimenting with features based on acceleration, but it didn’t lead to any substantial increase in accuracy on validation data. The features used were:</p> <ul> <li>Trip length</li> <li>Average speed</li> <li>Maximum speed</li> <li>Standard deviation of speed</li> <li>25, 50 and 75 percentiles of speed</li> </ul> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/scatter.svg" sizes="95vw"></source> <img src="/assets/img/scatter.svg" class="img-fluid" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Scatter plots of some of the features </div> <p>My workflow was based in two Python scripts. One for extracting features and one to validate models. I tried a multitude of models and hyperparameters, including:</p> <ul> <li>Random forests</li> <li>SVMs with rbf-kernels</li> <li>k-nn classifiers</li> </ul> <p>After removing some outliers I used k-fold cross validation to estimate generalization error of the different classifiers. After a bit of testing different models and tweaking hyperparameters I ended up with a random forest of 40 decision trees. This classifier had a balanced accuracy of ~80% on a 50-50 training-test split of the original dataset. Even though this is far from perfect I decided it was a good result given the data I had to work with. The classifier also showed good results when tested in practice on real trips.</p> <p>The fact that the dataset I worked with was fairly small was a challenge. I considered trying out the neural network approach, but it is likely that the size of the dataset would had made it very hard to train a network sufficiently. A perhaps even bigger challenge was how unbalanced the dataset was. Some classes, such as car and train had very few data points. My approach to this was to apply the <a href="https://arxiv.org/abs/1106.1813" rel="external nofollow noopener" target="_blank">SMOTE algorithm</a> for creating new, artificial samples from these classes. This gave a small increase in the balanced accuracy.</p> <p>Another challenge of this project was that the classifier had to be part of the final app. Since android apps are built in Java (or alternatively Kotlin) the final model had to be in Java code as well. As Java isn’t the greatest language for machine learning my approach to this was to use Python and scikit-learn for training the model, but then porting the final classifier to Java by using <a href="https://github.com/nok/sklearn-porter" rel="external nofollow noopener" target="_blank">sklearn-porter</a>. This worked great and I would definitely recommend sklearn-porter to anyone who prefers working with Python, but needs to port their models to some other language. The only downside of this approach was that I had to recreate the code for feature extraction both in Python and Java. For me this highlighted how we can not train machine learning models in a vacuum and as soon as we reach a good accuracy be done. Models exist as part of bigger systems and making a model work together with other parts of the system is just as important as being statistically accurate.</p> <div style="text-align: center; margin: 20px 0px;"> <img src="/assets/img/ecofootprint.png" width="300px" style="margin: auto"> <div class="caption"> Screenshot of the final app </div> </div> <p>There are a couple related problems that we avoided tackling thoroughly in this project. These include:</p> <ul> <li>Determining when trips start and stop</li> <li>Detecting when a building is entered.</li> <li>Real time updates of transport mode belief during trip</li> <li>Handling the many brief stops of public transport as one continuous trip.</li> </ul> <h3 id="why-is-this-even-useful">Why is This Even Useful?</h3> <p>So what is even the use case for automatic transport mode classification? One possible use is exactly what my course project targeted, to give people a better understanding of energy and emissions form their transportation habits. Few people would probably be interested in such a service if it required constant manual labeling of all their trips. These sorts of decision helping systems have shown to impact users behavior and thereby save energy. The effect is even stronger if social norms are introduced, where users are compared to others.</p> <p>More in general it is not hard to see that a dataset describing detailed transportation habits could be very valuable both for individuals and organizations that they choose to share it with. There are many great opportunities for research, urban planning, public transport etc.</p> </div> </article> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 Joel Oskarsson. Last updated: May 03, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>